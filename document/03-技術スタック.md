# 03 - 技術スタック

> [[02-アーキテクチャ設計]] | [[spotMe設計書]] | Next: [[04-データベース設計]]

## 🛠️ 技術スタック（最新版 2025年）

### 選定方針
- **実績のある技術**: 枯れた技術をベースに最新版を採用
- **学習コストを考慮**: Python 経験者が効率的に学習可能
- **開発生産性**: 高い開発生産性と保守性を重視
- **将来性**: 5年後も継続的に使用可能な技術

---

## 🐍 バックエンド技術スタック

### コア技術

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **フレームワーク** | FastAPI | 0.115.0 | 高性能・自動ドキュメント生成・型安全性 |
| **ASGI Server** | Uvicorn | 0.32.0 | 非同期処理・高いパフォーマンス |
| **Python** | Python | 3.12 | 最新の安定版・型ヒント強化 |

### データベース・ORM

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **ORM** | SQLAlchemy | 2.0.36 | 非同期対応・強力なクエリビルダー |
| **DB Driver** | asyncpg | 0.29.0 | PostgreSQL 最高性能ドライバー |
| **マイグレーション** | Alembic | 1.14.0 | SQLAlchemy 標準・自動マイグレーション |

### バリデーション・認証

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **バリデーション** | Pydantic | 2.9.2 | 型安全性・自動ドキュメント・高性能 |
| **認証** | Python-JOSE | 3.3.0 | JWT 認証・RS256 対応 |
| **パスワード** | Passlib | 1.7.4 | セキュアなハッシュ化 |

### HTTP・外部連携

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **HTTP Client** | HTTPX | 0.27.2 | 非同期対応・モダンAPI |
| **Redis Client** | redis-py | 5.0.8 | キャッシング・セッション管理 |

### GCP SDK・Firebase

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **GCP Core** | google-cloud-core | 2.4.1 | GCP 基盤ライブラリ |
| **Cloud SQL** | google-cloud-sql | 1.12.0 | Cloud SQL 管理 |
| **Cloud Storage** | google-cloud-storage | 2.18.0 | ファイルアップロード |
| **Secret Manager** | google-cloud-secret-manager | 2.21.1 | 機密情報管理 |
| **Firebase Admin** | firebase-admin | 6.5.0 | FCM・認証連携 |

### 開発・テスト

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **テスト** | pytest | 8.3.3 | 非同期テスト対応・豊富なプラグイン |
| **テストHTTP** | httpx[test] | 0.27.2 | FastAPI テストクライアント |
| **リント** | ruff | 0.7.3 | 高速・統合的コード品質 |
| **型チェック** | mypy | 1.13.0 | 静的型チェック |

---

## 📱 フロントエンド技術スタック

### コア技術

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **フレームワーク** | React Native | 0.76.1 | 最新安定版・New Architecture対応 |
| **言語** | TypeScript | 5.7.2 | 型安全性・開発生産性向上 |
| **Node.js** | Node.js | 20.x LTS | 長期サポート版 |

### ナビゲーション・UI

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **ナビゲーション** | React Navigation | 7.0.0 | 標準的な画面遷移ライブラリ |
| **UI Kit** | React Native Elements | 3.4.3 | 豊富なコンポーネント |
| **Vector Icons** | react-native-vector-icons | 10.2.0 | アイコンライブラリ |

### 地図・位置情報

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **地図** | React Native Maps | 1.18.0 | Google Maps・Apple Maps対応 |
| **位置情報** | @react-native-community/geolocation | 3.4.0 | GPS取得・高精度対応 |

### データ管理・通信

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **HTTP Client** | Axios | 1.7.9 | RESTful API 通信 |
| **データ取得** | TanStack Query | 5.62.0 | サーバー状態管理・キャッシング |
| **状態管理** | Zustand | 5.0.2 | 軽量・シンプルなグローバル状態 |

### Firebase・プッシュ通知

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **Firebase** | @react-native-firebase/app | 21.3.0 | Firebase Core |
| **FCM** | @react-native-firebase/messaging | 21.3.0 | プッシュ通知 |
| **Firestore** | @react-native-firebase/firestore | 21.3.0 | リアルタイムDB |

### 開発・テスト

| カテゴリ | 技術 | バージョン | 選定理由 |
|----------|------|------------|----------|
| **テスト** | Jest | 29.7.0 | ユニットテスト |
| **Component Test** | @testing-library/react-native | 12.8.1 | コンポーネントテスト |
| **E2E Test** | Detox | 20.27.3 | E2Eテスト自動化 |
| **Lint** | ESLint | 9.14.0 | コード品質管理 |

---

## 🔧 開発環境・ツール

### バージョン管理・CI/CD

| カテゴリ | 技術 | 用途 |
|----------|------|------|
| **Git** | GitHub | ソースコード管理・Issue管理 |
| **CI/CD** | Cloud Build | 自動テスト・デプロイ |
| **Container** | Docker | 本番環境の再現性 |

### 開発ツール

| カテゴリ | 技術 | 用途 |
|----------|------|------|
| **IDE** | VS Code | 開発環境・拡張機能豊富 |
| **API Doc** | FastAPI Swagger | 自動API ドキュメント |
| **Database** | DBeaver | DB管理・クエリ実行 |

### 監視・ログ

| カテゴリ | 技術 | 用途 |
|----------|------|------|
| **APM** | Cloud Monitoring | パフォーマンス監視 |
| **ログ** | Cloud Logging | 構造化ログ管理 |
| **エラー** | Firebase Crashlytics | クラッシュレポート |

---

## 📦 依存関係管理

### バックエンド（requirements.txt）

```python
# Core Framework
fastapi==0.115.0
uvicorn[standard]==0.32.0

# Database
sqlalchemy==2.0.36
asyncpg==0.29.0
alembic==1.14.0

# Validation & Auth
pydantic==2.9.2
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4

# HTTP & Utils
httpx==0.27.2
redis==5.0.8

# GCP & Firebase
google-cloud-storage==2.18.0
google-cloud-secret-manager==2.21.1
firebase-admin==6.5.0

# Development
pytest==8.3.3
pytest-asyncio==0.24.0
ruff==0.7.3
mypy==1.13.0
```

### フロントエンド（package.json）

```json
{
  "dependencies": {
    "react-native": "0.76.1",
    "typescript": "5.7.2",
    "@react-navigation/native": "^7.0.0",
    "react-native-maps": "^1.18.0",
    "@react-native-community/geolocation": "^3.4.0",
    "axios": "^1.7.9",
    "@tanstack/react-query": "^5.62.0",
    "zustand": "^5.0.2",
    "@react-native-firebase/app": "^21.3.0",
    "@react-native-firebase/messaging": "^21.3.0",
    "@react-native-firebase/firestore": "^21.3.0"
  },
  "devDependencies": {
    "jest": "^29.7.0",
    "@testing-library/react-native": "^12.8.1",
    "detox": "^20.27.3",
    "eslint": "^9.14.0",
    "@typescript-eslint/parser": "^8.13.0"
  }
}
```

---

## 🎯 技術選定の判断基準

### FastAPI を選ぶ理由
1. **Python開発者に最適**: 既存スキルを活用
2. **高性能**: Starlette ベースの非同期処理
3. **自動ドキュメント**: Swagger UI 自動生成
4. **型安全性**: Pydantic との強力な連携

### React Native を選ぶ理由
1. **クロスプラットフォーム**: iOS/Android 同時開発
2. **ネイティブ性能**: New Architecture で性能向上
3. **豊富なライブラリ**: 地図・位置情報の選択肢多数
4. **学習コスト**: Web 開発者にとって習得しやすい

### GCP を選ぶ理由
1. **Firebase 統合**: プッシュ通知・リアルタイムDB
2. **サーバーレス**: 運用負荷の軽減
3. **コスト効率**: 段階的なスケーリング
4. **地理的分散**: アジア太平洋地域の最適化

---

## 🔄 バージョンアップ戦略

### 定期アップデート計画

| カテゴリ | 頻度 | タイミング |
|----------|------|------------|
| **セキュリティパッチ** | 即座 | CVE 公開時 |
| **マイナーバージョン** | 月次 | 月末メンテナンス |
| **メジャーバージョン** | 四半期 | 計画的移行期間 |

### 互換性管理
- **Backwards Compatibility**: API バージョニング
- **Database Migration**: Alembic による段階的移行
- **Mobile App**: App Store 審査期間を考慮

---

## 📊 パフォーマンス最適化

### バックエンド最適化
- **接続プール**: SQLAlchemy async pool
- **レスポンス圧縮**: GZip 圧縮
- **キャッシング**: Redis + CDN

### フロントエンド最適化
- **Code Splitting**: 動的インポート
- **Image Optimization**: WebP 対応
- **Bundle Size**: Metro bundler 最適化

---

**Next**: [[04-データベース設計]] - PostgreSQL + Firestore ハイブリッド構成